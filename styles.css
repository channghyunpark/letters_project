:root { 
  --bg:#fafaf9; --fg:#333; --muted:#999; --anim-ms:400;
  --border:#eaeaea; --border-hover:#dcdcdc; --btn-bg:#fafaf9; --btn-hover:#fdfdfc;
  --stage-bg:#ffffff; --panel-bg:rgba(255,255,255,0.7); --toast-bg:#333; --toast-fg:#f6f6f6;
}
[data-theme="dark"] {
  --bg:#1a1a1a; --fg:#e0e0e0; --muted:#888;
  --border:#333; --border-hover:#555; --btn-bg:#2a2a2a; --btn-hover:#3a3a3a;
  --stage-bg:#222; --panel-bg:rgba(26,26,26,0.5); --toast-bg:#f0f0f0; --toast-fg:#333;
}

/* === FULLSCREEN LAYOUT === */
html,body{height:100%;margin:0;background:var(--bg);color:var(--fg);font-family:"Futura",ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Noto Sans,Helvetica,Arial,Apple SD Gothic Neo,"Malgun Gothic",sans-serif}
.wrap{display:grid;grid-template-rows:1fr;min-height:100dvh}
:lang(ko) { font-family: "Pretendard Variable", "Noto Sans KR", "Apple SD Gothic Neo", "Malgun Gothic", sans-serif; }

.stage{
  position:relative;overflow:hidden;isolation:isolate;
  height:100dvh;
  margin:0;
  border:1px solid var(--border);
  border-radius:0;
  background:var(--stage-bg);
  touch-action:none; /* ← 기본 스크롤/줌 제스처 차단 */
}

.pan-hint {
  font-family: "JetBrains Mono", "Menlo", "Consolas", monospace;
  letter-spacing: 0.5px;
}
.content{position:absolute;inset:0;transform-origin:0 0}
.start-overlay{
  position:absolute;
  inset:0;
  display:flex;
  align-items:flex-start;
  justify-content:center;
  padding-top:12vh;
  font-size:16px;
  text-align:center;
  pointer-events:none;
}
.start-overlay p{
  margin:0;
  padding:0;
  border-radius:0;
  background:none;
  color:#666;
  font-family:"JetBrains Mono","Menlo","Consolas",monospace;
  letter-spacing:0.5px;
}
[data-theme="dark"] .start-overlay p{
  color:rgba(210,210,210,0.75);
}
.start-overlay.is-hidden{
  opacity:0;
  visibility:hidden;
  transition:opacity 0.3s ease, visibility 0s linear 0s;
}

.selection-box{
  position:absolute;
  background:rgba(130,160,255,0.24);
  border-radius:6px;
  pointer-events:none;
  box-shadow:none;
  transition:opacity 0.1s ease;
  opacity:0;
}
.content.selection-active .selection-box{
  opacity:1;
}

.glyph{position:absolute;left:0;top:0;transform:translate3d(0,0,0);transition:transform var(--anim-ms) cubic-bezier(.22,.61,.36,1),opacity var(--anim-ms) ease;will-change:transform;font-size:18px;line-height:1;color:var(--fg);user-select:none;white-space:pre}
.caret{
  mix-blend-mode:normal;
  width:2px;
  height:22px;
  background:var(--fg);
  border-radius:1px;
}
.caret.is-active{
  animation:caretBlink 1.1s steps(1,start) infinite;
}

@keyframes caretBlink{
  0%,100%{opacity:0.15}
  50%{opacity:1}
}

/* Hidden proxy input for direct-on-stage typing */
.proxyInput{position:fixed;left:-9999px;top:-9999px;width:1px;height:1px;opacity:0;}

/* Zoom UI */
.zoomDock{
  position:absolute;right:12px;bottom:12px;display:flex;gap:4px;
  background:rgba(255,255,255,0.82);border:1px solid rgba(234,234,234,0.95);border-radius:8px;padding:4px 6px;backdrop-filter:blur(6px);box-shadow:0 8px 18px rgba(12,16,24,0.08)
}
.zbtn{appearance:none;border:1px solid rgba(220,220,220,0.9);background:rgba(255,255,255,0.9);color:var(--fg);font-size:11px;padding:4px 8px;border-radius:5px;cursor:pointer;transition:all 0.2s ease, transform 0.15s ease}
.zbtn:hover{border-color:rgba(205,205,205,0.95);background:rgba(255,255,255,0.98);transform:translateY(-1px)}
.zbtn:active{transform:translateY(0);box-shadow:0 1px 3px rgba(0,0,0,0.08) inset}
[data-theme="dark"] .zoomDock{
  background:rgba(32,34,41,0.72);
  border:1px solid rgba(70,72,80,0.7);
  box-shadow:0 10px 26px rgba(0,0,0,0.35);
}
[data-theme="dark"] .zbtn{
  border:1px solid rgba(88,90,102,0.8);
  background:rgba(54,56,66,0.78);
  color:rgba(230,233,243,0.94);
}
[data-theme="dark"] .zbtn:hover{
  border-color:rgba(104,107,122,0.9);
  background:rgba(66,68,80,0.88);
}
[data-theme="dark"] .zbtn:active{
  box-shadow:0 1px 3px rgba(0,0,0,0.45) inset;
}
.stage.panning{cursor:grab}
.stage.dragging{cursor:grabbing}

/* Toast */
.toast{position:fixed;left:50%;bottom:20px;transform:translateX(-50%);background:var(--toast-bg);color:var(--toast-fg);padding:6px 10px;border-radius:6px;font-size:11px;opacity:0;pointer-events:none;transition:opacity .25s ease}
.toast.show{opacity:.9}

/* Pan hint */
.pan-hint{position:absolute;left:12px;bottom:12px;color:var(--muted);font-size:10px;pointer-events:none;user-select:none}

/* === PANEL (dark-mode only) === */
.panel{
  position:absolute;
  left:12px; top:12px; z-index:5;
  background:none; border:none; backdrop-filter:none;
  padding:0; margin:0;
}
.dark-toggle{
  appearance:none;
  background:none;
  border:1px solid var(--border-hover);
  border-radius:6px;
  color:var(--fg);
  font-size:18px;
  line-height:1;
  cursor:pointer;
  padding:6px 8px;
  transition:background .2s ease,border-color .2s ease,transform .15s ease;
}
.dark-toggle:hover{
  background:var(--btn-hover);
  border-color:var(--border);
  transform:scale(1.06);
  color:var(--muted);
}
.dark-toggle:active{ transform:scale(0.95); }
